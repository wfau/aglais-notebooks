{
  "paragraphs": [
    {
      "title": "Introduction",
      "text": "%md\n\nThe science exploitation platform currently hosts the following data sets:\n\n* The Gaia EDR3 source catalogue (a direct mirror of gaiaedr3.gaia_source from the Gaia archive);\n* Best neighbour tables for PanSTARRS DR1, 2MASS PSC and ALLWISE (again, directly mirrored from the corresponding tables in the Gaia archive under the gaiaedr3 namespace) along with the original records from the 2MASS PSC and ALLWISE catalogues, and Object Thin / Object Mean columns from PanSTARRS DR1 (respectively 2MASS, ALLWISE and PS1 hereafter) where a best neighbour is available.\n\nThese are presented as SQL-queryable resources as demonstrated in the following cells. Click on the outward-pointing arrows in the top right of each cell to show the code; click on inward-pointing arrows to hide. Each cell can be run by pressing the play icon in the top-right; click on the cog icon to see other options, e.g. to clear current output. Note that the variant of SQL here is [PySpark SQL](https://spark.apache.org/docs/3.0.0/sql-ref.html), not ADQL.",
      "user": "gaiauser",
      "dateUpdated": "2021-12-12 21:50:58.368",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eThe science exploitation platform currently hosts the following data sets:\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003eThe Gaia EDR3 source catalogue (a direct mirror of gaiaedr3.gaia_source from the Gaia archive);\u003c/li\u003e\n  \u003cli\u003eBest neighbour tables for PanSTARRS DR1, 2MASS PSC and ALLWISE (again, directly mirrored from the corresponding tables in the Gaia archive under the gaiaedr3 namespace) along with the original records from the 2MASS PSC and ALLWISE catalogues, and Object Thin / Object Mean columns from PanSTARRS DR1 (respectively 2MASS, ALLWISE and PS1 hereafter) where a best neighbour is available.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThese are presented as SQL-queryable resources as demonstrated in the following cells. Click on the outward-pointing arrows in the top right of each cell to show the code; click on inward-pointing arrows to hide. Each cell can be run by pressing the play icon in the top-right; click on the cog icon to see other options, e.g. to clear current output. Note that the variant of SQL here is \u003ca href\u003d\"https://spark.apache.org/docs/3.0.0/sql-ref.html\"\u003ePySpark SQL\u003c/a\u003e, not ADQL.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639345858368_1416493291",
      "id": "20210507-123801_497865463",
      "dateCreated": "2021-12-12 21:50:58.368",
      "status": "READY"
    },
    {
      "title": "Database and table details",
      "text": "%pyspark\n\n# show the database(s) available within the context\nspark.sql(\"show databases\").show()\n\n# show the contents of the catalogue store that has been set up\nprint(\"Tables available:\")\nfor line in spark.catalog.listTables(): print (line)\n\n# show the first 20 records from the Gaia source catalogue\nprint(\"\\nFirst 20 entries in gaia_source:\")\nspark.sql(\"select * from gaia_source\").show()\n",
      "user": "gaiauser",
      "dateUpdated": "2021-12-12 21:50:58.368",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------------+\n|databaseName|\n+------------+\n|     default|\n|    gaiaedr3|\n+------------+\n\nTables available:\nTable(name\u003d\u0027gaia_source\u0027, database\u003d\u0027gaiaedr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse)\nTable(name\u003d\u0027gaia_source_allwise_best_neighbours\u0027, database\u003d\u0027gaiaedr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse)\nTable(name\u003d\u0027gaia_source_ps1_best_neighbours\u0027, database\u003d\u0027gaiaedr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse)\nTable(name\u003d\u0027gaia_source_tmasspsc_best_neighbours\u0027, database\u003d\u0027gaiaedr3\u0027, description\u003dNone, tableType\u003d\u0027EXTERNAL\u0027, isTemporary\u003dFalse)\n\nFirst 20 entries in gaia_source:\n+-------------------+--------------------+----------------+------------+---------+------------------+-----------+-------------------+-----------+--------------------+--------------+-------------------+----------+-------------------+-----------+--------------------+-----------+------------+----------------+------------+-------------+-----------------+-------------+--------------+------------------+-------------------+---------------+--------------------+--------------------+-------------------------+------------------------+------------------+-------------------+------------------------+----------------------------+-------------------------+------------------------+-------------------------+------------+------------------+--------------------+---------------------+--------------------------+----------------------+-----------------------+----------------------------+-----------------------+-----------------------+----------------+--------------------+------------------------+--------------------------+----------------------+-------------------+----------------+----------+--------------------------+--------------------------+--------------------------+--------------------------+----------------------+----------------------+----------------------+----------------------+-----------------+------------+------------------+----------------------+---------------------------+---------------+-------------+------------------+-----------------------+----------------------------+----------------+-------------+------------------+-----------------------+----------------------------+----------------+-------------------------------+--------------------------+-------------------------------+--------------------------+--------------+------------------------+----------+-----------+----------+-------------------+-------------------------+------------------+--------------------+--------------------+--------------------+------------------+-------------------+------------------+-------------------+\n|        solution_id|         designation|       source_id|random_index|ref_epoch|                ra|   ra_error|                dec|  dec_error|            parallax|parallax_error|parallax_over_error|        pm|               pmra| pmra_error|               pmdec|pmdec_error| ra_dec_corr|ra_parallax_corr|ra_pmra_corr|ra_pmdec_corr|dec_parallax_corr|dec_pmra_corr|dec_pmdec_corr|parallax_pmra_corr|parallax_pmdec_corr|pmra_pmdec_corr|astrometric_n_obs_al|astrometric_n_obs_ac|astrometric_n_good_obs_al|astrometric_n_bad_obs_al|astrometric_gof_al|astrometric_chi2_al|astrometric_excess_noise|astrometric_excess_noise_sig|astrometric_params_solved|astrometric_primary_flag|nu_eff_used_in_astrometry|pseudocolour|pseudocolour_error|ra_pseudocolour_corr|dec_pseudocolour_corr|parallax_pseudocolour_corr|pmra_pseudocolour_corr|pmdec_pseudocolour_corr|astrometric_matched_transits|visibility_periods_used|astrometric_sigma5d_max|matched_transits|new_matched_transits|matched_transits_removed|ipd_gof_harmonic_amplitude|ipd_gof_harmonic_phase|ipd_frac_multi_peak|ipd_frac_odd_win|      ruwe|scan_direction_strength_k1|scan_direction_strength_k2|scan_direction_strength_k3|scan_direction_strength_k4|scan_direction_mean_k1|scan_direction_mean_k2|scan_direction_mean_k3|scan_direction_mean_k4|duplicated_source|phot_g_n_obs|  phot_g_mean_flux|phot_g_mean_flux_error|phot_g_mean_flux_over_error|phot_g_mean_mag|phot_bp_n_obs| phot_bp_mean_flux|phot_bp_mean_flux_error|phot_bp_mean_flux_over_error|phot_bp_mean_mag|phot_rp_n_obs| phot_rp_mean_flux|phot_rp_mean_flux_error|phot_rp_mean_flux_over_error|phot_rp_mean_mag|phot_bp_n_contaminated_transits|phot_bp_n_blended_transits|phot_rp_n_contaminated_transits|phot_rp_n_blended_transits|phot_proc_mode|phot_bp_rp_excess_factor|     bp_rp|       bp_g|      g_rp|dr2_radial_velocity|dr2_radial_velocity_error|dr2_rv_nb_transits|dr2_rv_template_teff|dr2_rv_template_logg|dr2_rv_template_fe_h|                 l|                  b|           ecl_lon|            ecl_lat|\n+-------------------+--------------------+----------------+------------+---------+------------------+-----------+-------------------+-----------+--------------------+--------------+-------------------+----------+-------------------+-----------+--------------------+-----------+------------+----------------+------------+-------------+-----------------+-------------+--------------+------------------+-------------------+---------------+--------------------+--------------------+-------------------------+------------------------+------------------+-------------------+------------------------+----------------------------+-------------------------+------------------------+-------------------------+------------+------------------+--------------------+---------------------+--------------------------+----------------------+-----------------------+----------------------------+-----------------------+-----------------------+----------------+--------------------+------------------------+--------------------------+----------------------+-------------------+----------------+----------+--------------------------+--------------------------+--------------------------+--------------------------+----------------------+----------------------+----------------------+----------------------+-----------------+------------+------------------+----------------------+---------------------------+---------------+-------------+------------------+-----------------------+----------------------------+----------------+-------------+------------------+-----------------------+----------------------------+----------------+-------------------------------+--------------------------+-------------------------------+--------------------------+--------------+------------------------+----------+-----------+----------+-------------------+-------------------------+------------------+--------------------+--------------------+--------------------+------------------+-------------------+------------------+-------------------+\n|1636042515805110273|Gaia EDR3 6975027...|   6975027056128|  1483567527|   2016.0|44.976206974203215|   6.286595|0.19597223687938073|   6.579695|                null|          null|               null|      null|               null|       null|                null|       null|  0.29922372|            null|        null|         null|             null|         null|          null|              null|               null|           null|                 119|                   0|                      117|                       2|          33.31858|          1712.7683|               29.535458|                    57.43254|                        3|                   false|                     null|        null|              null|                null|                 null|                      null|                  null|                   null|                          14|                     10|              15.699378|              14|                   0|                       1|                0.27858797|             158.74265|                  5|               0|      null|                0.43844327|                0.21942271|                0.49627775|                0.90088254|             -76.38099|            -44.351624|            -51.597004|              28.99931|            false|         117| 59.67959423268159|             1.4269171|                   41.82415|      21.247803|           12|100.94257860605804|             10.9332075|                    9.232659|       20.328356|           12| 231.1856715084043|              17.364918|                   13.313375|       18.837994|                              0|                         0|                              0|                         0|             0|               5.5651894| 1.4903622|-0.91944695|  2.409809|               null|                     null|                 0|                null|                null|                null| 176.7220095980222| -48.78359500563965| 42.57195708292756| -16.14172752802797|\n|1636042515805110273|Gaia EDR3 6941096...|  69410967253632|   882970315|   2016.0| 45.33365180640389|0.059728276| 0.8065718615590686|0.056550715|  1.4555745777726423|   0.069192156|          21.036701| 12.634331|   4.70129741641548| 0.07916925|  11.727067592269952| 0.07239824| 0.051099323|      0.13106872| -0.06286451| -0.017324463|      -0.26891813|  -0.07415933|   -0.16740274|        0.14137655|          0.1564841|     0.09251184|                 244|                   0|                      243|                       1|         1.3907971|          281.91693|              0.21088322|                   1.4841777|                       31|                   false|                1.3469117|        null|              null|                null|                 null|                      null|                  null|                   null|                          28|                     16|            0.112235606|              28|                  11|                       0|              0.0114030875|              99.70103|                  0|               0|   1.06299|                0.22973558|               0.118613124|                0.31885144|                 0.9025332|            -90.735954|            -12.181437|            -47.795223|              28.91269|            false|         241| 3162.497934560943|             2.4779444|                  1276.2587|      16.937292|           26|  936.552311468738|               11.70469|                    80.01513|       17.909712|           23|3272.8581872558507|               12.25079|                   267.15488|       15.960578|                              0|                         2|                              0|                         1|             0|               1.3310398| 1.9491339| 0.97241974|0.97671413|               null|                     null|                 0|                null|                null|                null| 176.4379004442429| -48.10163529201089|  43.1126320446136|-15.661929935595563|\n|1636042515805110273|Gaia EDR3 2259496...| 225949639778432|  1536143549|   2016.0| 45.44124688351276| 0.02803212| 1.1954836699775477|0.028446209|   1.394218591245696|   0.037935108|          36.752724|  20.43043| 13.686160801042636|0.035126183| -15.168765487469134| 0.03174646|-0.019850498|      0.15453939| -0.21436352|  0.088532254|      -0.55213827| -0.010984938|   -0.29761195|         0.0960615|         0.27353108|      0.1762881|                 186|                   0|                      186|                       0|        0.62427783|          199.31598|                     0.0|                         0.0|                       31|                   false|                1.4725757|        null|              null|                null|                 null|                      null|                  null|                   null|                          21|                     13|             0.05165987|              21|                  10|                       0|                0.06161675|              157.6855|                  0|               0|  1.031129|                 0.3671181|                0.18351476|                0.52543354|                0.83258176|            -110.36826|            -10.036644|            -45.478645|              28.91582|            false|         175|15907.169226453389|              5.818997|                  2733.6619|      15.183385|           18| 7229.919472799675|              52.288242|                   138.27046|       15.690708|           17|12423.841777734518|              23.445293|                    529.9077|       14.512256|                              0|                         1|                              0|                         0|             0|               1.2355285| 1.1784525| 0.50732327| 0.6711292|               null|                     null|                 0|                null|                null|                null|176.13575886747824|-47.752583635978624| 43.33646657602516|-15.320904975289592|\n|1636042515805110273|Gaia EDR3 3126435...| 312643555148800|  1165653362|   2016.0| 44.19331490047449| 0.62786114| 1.0141376381509917|  0.6046053|  -2.406035470350596|     0.7910185|          -3.041693| 1.9266281| 0.7359626112174777|  0.8090645| -1.7805210041764188|  1.0207198|   0.1925851|      0.35358006| -0.17067225|  -0.12039981|      -0.14308637|  0.020793572|  -0.009585112|       -0.13178577|          -0.314985|     0.57411194|                 170|                   0|                      169|                       1|         0.6875274|          190.30516|               1.4839106|                  0.84467053|                       31|                   false|                1.5261779|        null|              null|                null|                 null|                      null|                  null|                   null|                          19|                     13|               1.624189|              20|                   6|                       0|               0.046008017|             164.19011|                  0|               0| 1.0361441|                0.26284847|                0.21518542|                0.26070628|                 0.8666013|             -51.21893|            -38.693382|             -55.03068|             28.318026|            false|         167| 133.9746688344942|             1.0208433|                  131.23921|       20.36981|           16| 89.77062085708957|               9.126085|                    9.836706|       20.455708|           15| 78.94180432064533|               6.484244|                   12.174404|       20.004627|                              0|                         0|                              0|                         0|             0|                1.259286|0.45108032|0.085897446|0.36518288|               null|                     null|                 0|                null|                null|                null| 175.0040402864177| -48.76352420146662| 42.04494239957736|-15.129465134218371|\n|1636042515805110273|Gaia EDR3 4428970...| 442897027616128|  1032562394|   2016.0| 44.91264312888683| 0.93061656|  1.492601852016502| 0.66022867|  -0.250188087896396|     1.1772038|        -0.21252741|  9.205325| 7.1107438243095125| 0.97728163|  -5.845967628195836|  0.8776213| -0.10951689|       0.5899458|  0.14786735|  -0.22949727|       -0.3623166|-0.0021650686|     0.1795118|       -0.13498302|        -0.36171502|     0.32059658|                 131|                   0|                      130|                       1|         1.8643658|          167.56996|               2.0693786|                   1.9396355|                       31|                   false|                1.5010159|        null|              null|                null|                 null|                      null|                  null|                   null|                          15|                     12|              1.5151538|              15|                   4|                       0|                0.16777302|             160.37517|                  0|               0| 1.1174322|                 0.4559067|                0.19909912|                0.46386027|                 0.8504971|             -54.00579|             -6.771922|            -56.847355|              28.50644|            false|         128| 139.9946830588604|             1.6376594|                   85.48461|      20.322088|           11| 73.08588223932418|             14.4919195|                    5.043216|       20.678959|           10| 98.07669209445086|              10.735952|                    9.135351|        19.76898|                              0|                         0|                              0|                         0|             0|               1.2226362|0.90997887| 0.35687065| 0.5531082|               null|                     null|                 0|                null|                null|                null|175.26668851939087|-47.917572627074705|42.902075973063596|-14.883113514004386|\n|1636042515805110273|Gaia EDR3 4743018...| 474301831162240|   972185935|   2016.0| 45.48856296035135|  1.3412501| 1.8741327094367917|  2.2440224|                null|          null|               null|      null|               null|       null|                null|       null|   0.4530527|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  79|                   0|                       79|                       0|          2.112092|          101.95571|                3.006386|                   1.3451056|                        3|                   false|                     null|        null|              null|                null|                 null|                      null|                  null|                   null|                           9|                      7|                5.89936|               9|                   2|                       2|               0.025648486|             13.771114|                  0|               0|      null|                 0.4735477|                0.23929663|                 0.6658959|                0.82473654|            -115.52151|             -37.02479|            -46.518726|             27.180376|            false|          78| 87.30894165425046|             1.1723217|                   74.47524|       20.83472|            6|48.197829605649105|              18.048208|                    2.670505|       21.130974|            7| 75.48646686913158|              17.571936|                   4.2958536|       20.053223|                              0|                         1|                              0|                         0|             0|                1.416628| 1.0777512|  0.2962532|0.78149796|               null|                     null|                 0|                null|                null|                null| 175.4720609143094| -47.24098540734314| 43.58627822369509|-14.684840092083016|\n|1636042515805110273|Gaia EDR3 5031296...| 503129650290944|   315470884|   2016.0| 44.82557241329517|  4.1719084| 1.7467209989897743|  3.5646226|                null|          null|               null|      null|               null|       null|                null|       null|  0.62036026|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  61|                   0|                       58|                       3|         5.6112413|           133.0689|                7.927556|                    5.402304|                        3|                   false|                     null|        null|              null|                null|                 null|                      null|                  null|                   null|                           7|                      7|              7.9379845|               7|                   2|                       0|                 0.3972154|              79.30429|                  0|               0|      null|                 0.5941456|                0.37184286|                0.35302737|                 0.8749616|            -18.627172|            -48.146687|             55.498154|             33.309174|            false|           0|              null|                  null|                       null|           null|            0|              null|                   null|                        null|            null|            5|100.95071111316442|              18.407742|                    5.484144|       19.737621|                           null|                      null|                              0|                         0|             0|                    null|      null|       null|      null|               null|                     null|                 0|                null|                null|                null|174.90816509907003|-47.798060521965155|  42.8925881790442|-14.614659425660907|\n|1636042515805110273|Gaia EDR3 6482651...| 648265184276864|   595929781|   2016.0| 46.15329115883016| 0.29093397| 1.8187255026806104|  0.2861576|  1.5255306891268339|    0.34711465|            4.39489| 20.452862|-0.7535766767681108| 0.41305694|  20.438975348327737|  0.3612377|  0.22465913|    -0.055109307| 0.021011634|  0.065305956|       -0.3422249|   0.05481511|   -0.09854577|       0.047639098|         0.22327392|     0.18817557|                 192|                   0|                      190|                       2|         1.3077264|          239.17429|              0.95385814|                   1.5496614|                       95|                   false|                     null|   1.1951112|        0.09298585|          -0.0977814|           0.02421737|              -0.008054698|           -0.13709249|             -0.0920853|                          22|                     14|             0.59551215|              23|                   9|                       0|                0.02405558|             115.54224|                  0|               0| 1.0670869|                0.31977355|                 0.2045098|                0.51202905|                0.83172643|             -109.0452|            -25.814356|            -44.309353|             29.669565|            false|         199| 372.4263882091455|             1.3463038|                  276.62878|      19.259766|           21| 85.33926675390155|              12.529569|                     6.81103|        20.51067|           22|463.59450767808573|               11.62081|                    39.89348|        18.08255|                              0|                         0|                              0|                         0|             0|                1.473939| 2.4281197|  1.2509041| 1.1772156|               null|                     null|                 0|                null|                null|                null|176.21581351398206| -46.80805601464957| 44.22819373408532| -14.92842053758772|\n|1636042515805110273|Gaia EDR3 8536333...| 853633342492160|   705529208|   2016.0|45.887170370964405|  7.1719065| 1.9883446636479867|  7.6986904|                null|          null|               null|      null|               null|       null|                null|       null|  0.37340528|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  44|                   0|                       43|                       1|         2.7453742|           66.33871|                7.946553|                   2.9659421|                        3|                   false|                     null|        null|              null|                null|                 null|                      null|                  null|                   null|                           5|                      5|              47.182083|               5|                   1|                       0|               0.081784375|              91.90005|                  0|               0|      null|                 0.7912249|                 0.5642833|                 0.8263561|                0.89852434|            -69.591576|            -52.225998|             -49.80611|              34.12016|            false|          42| 69.65546803339504|               1.62717|                   42.80774|      21.079979|            2| 30.22762571931181|              2.1279361|                   14.205137|       21.637531|            2| 81.14061263038558|              19.717916|                   4.1150703|         19.9748|                              0|                         0|                              0|                         0|             0|               1.5988442| 1.6627312| 0.55755234| 1.1051788|               null|                     null|                 0|                null|                null|                null|175.76616519743376|-46.878204020977535| 44.01467547446078|-14.689880739078085|\n|1636042515805110273|Gaia EDR3 8634602...| 863460225866368|   645115016|   2016.0| 45.45010424853958| 0.31990552| 2.0228507314198554|  0.2960949|  1.1822526874913684|    0.35907117|          3.2925303|  9.336775|  8.722927324450673| 0.44381168|  3.3295508206110473| 0.36389756|  0.12174156|      0.12535466| 0.005469672|  0.041570682|      -0.16957298|  0.018502202|   -0.03951598|       0.060896136|        0.030126812|  -3.6944874E-4|                 214|                   0|                      213|                       1|         1.0816735|          241.63437|              0.78129023|                   0.7626421|                       95|                   false|                     null|   1.3475893|       0.100474566|         -0.13501225|          0.071071275|             -0.0068225404|            0.09367772|            -0.17150272|                          25|                     16|              0.6135779|              25|                   8|                       0|                  0.080066|             81.085396|                  0|               0| 1.0519915|                0.21111165|                 0.1615393|                0.28198647|                 0.8968768|            -83.846176|            -0.5082148|             -45.70425|             28.869308|            false|         210|250.09798574619302|             1.0249683|                  244.00558|      19.692091|           20|  65.4412283317245|              6.4674487|                   10.118554|       20.798914|           22| 271.0313875513038|                8.11049|                    33.41739|       18.665346|                              0|                         2|                              0|                         1|             0|               1.3453631| 2.1335678|   1.106823| 1.0267448|               null|                     null|                 0|                null|                null|                null|175.27746799452913| -47.16278687407757| 43.59254806496494| -14.53135523473774|\n|1636042515805110273|Gaia EDR3 1280793...|1280793609641728|  1294780040|   2016.0| 44.43124938681589|  1.2111858|  2.100706635709667|  1.5122597|-0.31006938724192246|     1.3184384|        -0.23517926| 2.8372014| 2.5253713581579413|  1.7493938| -1.2931401292881213|  2.2304711|   0.5581937|      0.14405505|  0.40427312|   0.53064615|      -0.17819723|   0.58755875|    0.71072936|        0.14447734|        -0.16789085|      0.7056266|                 119|                   0|                      118|                       1|         2.0498855|          152.47151|               2.6082418|                   2.1854734|                       95|                   false|                     null|   0.6124336|        0.28012156|         -0.11437417|         -0.010142161|               -0.06697472|            -0.2752646|            -0.01699514|                          14|                     10|              3.8768213|              14|                   3|                       0|                 0.1363149|              82.20611|                  0|               0| 1.1369365|                0.30544925|                0.33264703|                 0.4036386|                0.83001083|             -68.07546|            -46.499943|            -53.431717|             27.627811|            false|         116| 105.5672571666714|             1.3245269|                   79.70186|      20.628544|           10| 37.82353293181299|               7.514304|                    5.033538|       21.394136|           12|122.60627790224916|              13.756053|                    8.912896|       19.526613|                              0|                         1|                              0|                         1|             0|               1.5196929| 1.8675232|  0.7655926| 1.1019306|               null|                     null|                 0|                null|                null|                null|174.12004470069976|  -47.8194310644947| 42.61029364220551|-14.160950881200199|\n|1636042515805110273|Gaia EDR3 1393218...|1393218671780096|   614350229|   2016.0|44.187676857318436| 0.42796215| 2.6694704253082144| 0.47777948|   3.857765544169479|    0.49705428|           7.761256| 28.553991|  8.810283459026529|  0.6685142| -27.160804470406106|  0.7086528|  0.40537238|    -0.022808628|  0.25450307|   0.12806226|      -0.29210863|   0.12064501|    0.12389305|       -0.12750636|        -0.07816721|      0.6111952|                 169|                   0|                      168|                       1|          4.842442|           287.5426|               2.1246123|                     5.26361|                       31|                   false|                1.2170415|        null|              null|                null|                 null|                      null|                  null|                   null|                          20|                     14|              1.2159221|              20|                   7|                       0|                0.05807331|              80.84152|                  0|               0| 1.2776315|                0.25329608|                 0.3539184|                0.34836367|                0.86745346|             -80.27756|            -48.246773|            -46.783676|              29.47578|            false|         164|278.74935474916265|             1.1719753|                  237.84576|      19.574331|           15| 57.23836506129086|              10.298694|                    5.557828|       20.944324|           18| 384.1359532342214|              11.038819|                   34.798645|       18.286684|                              0|                         3|                              0|                         1|             0|               1.5834093| 2.6576405|  1.3699932| 1.2876472|               null|                     null|                 0|                null|                null|                null|173.27525534983812|-47.575631949422124| 42.54239463993526|-13.545832458006366|\n|1636042515805110273|Gaia EDR3 1428059...|1428059446105344|  1526494127|   2016.0|42.816607265146295|0.121525824| 2.0886145542579504| 0.13208582|  1.2982219530654744|    0.14732893|           8.811725|    8.4283|  7.498051549050791| 0.15423636| -3.8490861701617556| 0.15595877|   0.2651823|     0.045301285|  0.27877194|   0.11214057|       -0.4344541|   0.09942125|    0.21029775|     -0.0020576897|       -0.082502544|     0.39645484|                 192|                   0|                      192|                       0|         0.4098269|          203.07407|                     0.0|                         0.0|                       31|                   false|                1.3466755|        null|              null|                null|                 null|                      null|                  null|                   null|                          22|                     14|              0.2572881|              23|                   9|                       0|               0.046024103|             143.89977|                  1|               0| 1.0194718|                0.33296868|                0.25036186|                0.49393246|                0.83962834|             -91.76291|            -37.204544|            -45.518795|             29.316174|            false|         198|1191.6201035422957|             2.2020428|                    541.143|      17.997023|           21|331.85193577764386|              11.320016|                     29.3155|        19.03618|           20|1259.1217373298255|              13.031355|                   96.622475|       16.997726|                              0|                         1|                              0|                         0|             0|                1.335135|  2.038454|  1.0391579| 0.9992962|               null|                     null|                 0|                null|                null|                null|  172.363352854012|-48.934091221692796| 41.01898937865555|-13.693824087938523|\n|1636042515805110273|Gaia EDR3 1493793...|1493793921413120|  1039635114|   2016.0|42.757454396411674| 0.07188802|  2.452213240447886|0.057006825|   4.614414312625518|    0.07442283|          62.002674| 17.518242|  7.879793361575654|0.102847196|  15.646010426370495| 0.07850353| -0.06539644|      0.26996583|  0.20045374|  -0.03478322|      -0.23305279| -8.958094E-4|   0.116715476|       -0.08108545|       -0.091975495|     0.05493354|                 159|                 159|                      153|                       6|          45.32079|           5554.872|               0.5084283|                    218.8104|                       95|                   false|                     null|   1.5058784|        0.02297731|         -0.13521785|          0.055225443|               -0.13445123|          -0.009300035|           -0.003903841|                          18|                     13|             0.14339665|              23|                  23|                       0|               0.013840159|              88.09093|                 99|               0| 4.5867424|                      null|                      null|                      null|                      null|                  null|                  null|                  null|                  null|            false|         171|272894.56232397177|             217.28339|                  1255.9385|       12.09738|           20|216920.76993436954|              481.90704|                    450.1299|       11.997789|           18| 309234.2405452856|                593.188|                     521.309|       11.022177|                              0|                        20|                              0|                        18|             0|               1.9280524|0.97561264| -0.0995903|  1.075203|               null|                     null|                 0|                null|                null|                null|171.92466662988417| -48.70547042029443| 41.07327642394491|-13.329253975390913|\n|1636042515805110273|Gaia EDR3 1674835...|1674835382563840|   796335631|   2016.0| 43.44455576953005|  3.9080048| 3.2773066677599725|  2.5104022|                null|          null|               null|      null|               null|       null|                null|       null| -0.45033056|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  89|                   0|                       88|                       1|         7.2253585|          213.97752|               10.437896|                   10.416481|                        3|                   false|                     null|        null|              null|                null|                 null|                      null|                  null|                   null|                          11|                      9|                7.53586|              11|                   1|                       0|                0.12003679|             33.188515|                  0|               0|      null|                0.41290963|                0.17801794|                0.47531804|                 0.9294474|             -57.83677|              6.079559|            -59.518475|             27.726625|            false|          89| 87.00631483827635|             1.9763731|                  44.023224|       20.83849|            8|122.26726834966425|               18.68626|                   6.5431643|       20.120266|            8|469.67462332564435|              12.059974|                   38.944912|       18.068403|                              0|                         0|                              0|                         0|             0|                6.803436| 2.0518627| -0.7182236| 2.7700863|               null|                     null|                 0|                null|                null|                null| 171.8550731737217| -47.63330158032991|41.998134255185214|-12.746263145131172|\n|1636042515805110273|Gaia EDR3 1855288...|1855288436653952|  1733304442|   2016.0| 45.47653260521487|  0.5637633| 3.3701162952663966|   0.523944|  1.8638791585080992|     0.6514061|          2.8613167| 2.5794895|  2.301399939922569|  0.7093121|  1.1650428195764753|  0.7561295|  0.12878294|      0.29525062| -0.28048313|  -0.05095682|      -0.26083472|  -0.15685304|   -0.38561857|        0.12401442|         0.23357464|     0.45562065|                 179|                   0|                      179|                       0|         0.5857167|          193.82085|                     0.0|                         0.0|                       95|                   false|                     null|   1.5504931|        0.17942694|         -0.10240456|          -0.11101447|               -0.09883383|            0.07548761|             0.22898763|                          21|                     13|              1.2481813|              21|                   9|                       0|                0.04614994|              86.47955|                  0|               0| 1.0297067|                0.38988674|                0.17787333|                0.42907682|                0.88284016|              -61.9499|            -31.873905|            -53.023273|             30.496271|            false|         177|147.22594885278806|             1.0127305|                  145.37526|      20.267406|           16| 44.31811579273947|               7.881568|                   5.6230073|        21.22209|           15|190.21940613125895|              6.3340745|                   30.031128|       19.049759|                              0|                         0|                              0|                         0|             0|               1.5930448| 2.1723309|  0.9546833| 1.2176476|               null|                     null|                 0|                null|                null|                null|173.93258053079862| -46.18079023527432| 44.01746992808117|-13.248516036719874|\n|1636042515805110273|Gaia EDR3 2016951...|2016951004457088|   774127143|   2016.0| 44.91770710226973|  54.603943| 3.5664154263442804|   27.31215|                null|          null|               null|      null|               null|       null|                null|       null| -0.94140744|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  41|                   0|                       40|                       1|          9.511778|           188.0826|               17.605759|                   57.975224|                        3|                   false|                     null|        null|              null|                null|                 null|                      null|                  null|                   null|                           5|                      4|              26411.514|               5|                   0|                       0|                0.27526414|             162.65935|                  0|               0|      null|                 0.7598316|                0.17634737|                0.53525627|                 0.9438677|            -10.572814|             1.1036826|             41.675064|             29.136822|            false|          39| 77.84138517604423|             3.5135317|                  22.154741|      20.959341|            2| 3.133883775630284|             0.36283168|                    8.637294|       24.098335|            3| 93.85554312747541|               4.247715|                   22.095537|       19.816746|                              0|                         1|                              0|                         0|             0|               1.2459879| 4.2815895|  3.1389942| 1.1425953|               null|                     null|                 0|                null|                null|                null| 173.1516723867988| -46.42291167618815|43.527034624591394|-12.900006939689947|\n|1636042515805110273|Gaia EDR3 2088934...|2088934654473728|  1192120809|   2016.0|44.560611955234315|0.067317255|  3.937445649369211|0.058219843|  0.5598553771571455|     0.0804903|          6.9555635|0.95413685| 0.9531850007134551| 0.09751484|0.042608865230788516| 0.07856624| -0.06157681|      0.20958275| 0.046378154|-0.0070494376|      -0.33846262|  0.012401117|    -0.0672847|       -0.19778733|          0.2356919|    -0.06956348|                 202|                   0|                      202|                       0|         0.5218927|          215.40236|                     0.0|                         0.0|                       31|                   false|                1.5156522|        null|              null|                null|                 null|                      null|                  null|                   null|                          23|                     14|             0.13611974|              23|                   7|                       0|               0.053348754|              161.4443|                  0|               0| 1.0247011|                0.32424605|                0.16434103|                0.44034028|                 0.9012257|             -84.77881|            -7.9358716|            -48.312244|              29.55512|            false|         199|3119.8498046196455|              2.530685|                  1232.8085|      16.952032|           20| 1557.690947311291|              19.356539|                    80.47363|        17.35734|           20|2232.0168192334886|              8.8055105|                   253.47955|       16.376152|                              0|                         1|                              0|                         0|             0|               1.2147084| 0.9811878| 0.40530777|0.57588005|               null|                     null|                 0|                null|                null|                null| 172.4067450946103| -46.39436565630155| 43.28759386865556|-12.441682989341677|\n|1636042515805110273|Gaia EDR3 2358486...|2358486801948416|  1624988966|   2016.0|47.787928879606234| 0.41404787|  3.041189850119304| 0.38691062|-0.02833583539918...|    0.46328402|        -0.06116299|  7.991693| -4.419013203477653|  0.5819013|  -6.658789449198599| 0.53208315|  0.07373527|     -0.06591803|   0.1193303|   0.02305005|       -0.0344853|  0.037786216|    0.22160624|        -0.0712194|         0.26097566|   -0.025039291|                 193|                   0|                      190|                       3|        -2.0485363|          168.53934|                     0.0|                         0.0|                       95|                   false|                     null|   1.0872388|         0.1367584|        -0.008670707|         -0.116936795|              -0.043928318|          -0.019174939|            -0.15539953|                          24|                     16|             0.80822885|              24|                   8|                       0|                 0.0486846|             149.85074|                  0|               0| 0.8933911|                 0.2852967|                0.14482597|                0.36340344|                 0.8880398|            -86.215935|             -19.91311|            -45.506016|             29.745165|            false|         188|206.58930997304645|              1.191076|                  173.44763|      19.899597|           21| 65.19312000061988|               8.370515|                    7.788424|       20.803038|           19|224.41011775849344|               9.046666|                   24.805836|       18.870289|                              0|                         0|                              0|                         0|             0|               1.4018307| 1.9327488|  0.9034405| 1.0293083|               null|                     null|                 0|                null|                null|                null|176.59630156107573|-44.785381513024014|46.202139597555146|-14.213033428954754|\n|1636042515805110273|Gaia EDR3 2358800...|2358800334580352|   899009030|   2016.0| 47.73775437161764|0.029306399|  3.060588469149176|0.026214361| 0.44509496437292256|    0.03267364|          13.622449| 4.9514074| 4.3178451506337705|0.040636193|   -2.42335482915944| 0.03377079|  0.04488097|      0.08625572| 0.076442994| -0.041745245|      -0.18486245|  -0.06310363|    0.08371441|       0.020416116|        0.121363565|    -0.04331796|                 246|                   0|                      244|                       2|       -0.08168851|          246.99014|                     0.0|                         0.0|                       31|                    true|                1.5177574|        null|              null|                null|                 null|                      null|                  null|                   null|                          28|                     16|            0.056376517|              28|                   9|                       0|                 0.0584521|             158.72786|                  0|               0|0.99487334|                0.22431892|                 0.1452303|                0.31849405|                 0.8791434|             -89.10202|            -15.676008|            -46.533535|              28.92276|            false|         243| 10380.70673576311|              4.107552|                  2527.2246|      15.646799|           28| 5141.863359317464|               14.00675|                   367.09897|       16.060741|           26| 7466.366261757904|              14.963299|                   498.97864|       15.065123|                              0|                         0|                              0|                         1|             0|               1.2145829| 0.9956188| 0.41394234| 0.5816765|               null|                     null|                 0|                null|                null|                null|176.52751195137904|-44.807828192146474| 46.15798128243941|-14.180568248103617|\n+-------------------+--------------------+----------------+------------+---------+------------------+-----------+-------------------+-----------+--------------------+--------------+-------------------+----------+-------------------+-----------+--------------------+-----------+------------+----------------+------------+-------------+-----------------+-------------+--------------+------------------+-------------------+---------------+--------------------+--------------------+-------------------------+------------------------+------------------+-------------------+------------------------+----------------------------+-------------------------+------------------------+-------------------------+------------+------------------+--------------------+---------------------+--------------------------+----------------------+-----------------------+----------------------------+-----------------------+-----------------------+----------------+--------------------+------------------------+--------------------------+----------------------+-------------------+----------------+----------+--------------------------+--------------------------+--------------------------+--------------------------+----------------------+----------------------+----------------------+----------------------+-----------------+------------+------------------+----------------------+---------------------------+---------------+-------------+------------------+-----------------------+----------------------------+----------------+-------------+------------------+-----------------------+----------------------------+----------------+-------------------------------+--------------------------+-------------------------------+--------------------------+--------------+------------------------+----------+-----------+----------+-------------------+-------------------------+------------------+--------------------+--------------------+--------------------+------------------+-------------------+------------------+-------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639345858368_71863782",
      "id": "20210507-124436_282498395",
      "dateCreated": "2021-12-12 21:50:58.368",
      "status": "READY"
    },
    {
      "title": "Description and links",
      "text": "%md\n\n\u003cbr\u003e\nThe database context is presently gaiaedr3 at start-up, so all that is needed to identify a table is the name (the first item in each record above) in queries. The column description for gaia_source is browsable within the Gaia archive ADQL search tree-view, and also [online](https://gea.esac.esa.int/archive/documentation/GEDR3/Gaia_archive/chap_datamodel/sec_dm_main_tables/ssec_dm_gaia_source.html), as are the [best neighbour table columns](https://gea.esac.esa.int/archive/documentation/GEDR3/Gaia_archive/chap_datamodel/sec_dm_crossmatches/). For the \"external\" catalogues the column sets can be browsed as follows (click on each to follow the links):\n\n* [2MASS PSC](https://old.ipac.caltech.edu/2mass/releases/allsky/doc/sec2_2a.html \"2MASS point-source catalogue column details\");\n* [ALLWISE](https://wise2.ipac.caltech.edu/docs/release/allwise/expsup/sec2_1a.html \"ALLWISE catalogue column details\");\n* [PS1 OTMO](https://outerspace.stsci.edu/display/PANSTARRS/PS1+MeanObjectView+table+fields \"PS1 DR1 object-thin object-mean catalogue column details\") (note that column names follow the Gaia archive convention of all lower-case with underscore separators rather than the original CamelCase).\n\nIt is important to note that the best neighbour tables should not be used as a proxy for the original external survey datasets: only those records that are the best neighbour to one or more Gaia sources are included here. If you wish to query and analyse one or other of those catalogues in isolation, this is not the facility to use! The phrase \"one or more\" is also noteworthy: because of the way the Gaia cross-matches have been derived any one external catalogue source can be the best neighbour to more than one Gaia source. Please consult the [Gaia cross-match documentation on-line](https://gea.esac.esa.int/archive/documentation/GEDR3/Catalogue_consolidation/chap_crossmatch/) to familiarise yourself with the details.\n\nNote also the syntax in the last query above. At first sight this might look insanely profligate, especially if you are familiar with existing relational systems serving Gaia data via ADQL/TAP. On this Spark platform the execution engine works rather differently: a \"lazy\" execution plan is assembled from the workflow as notebook statements and cells are \"played\" through this interface - nothing actually happens until absolutely necessary. So the select statement is not executed: rather an optimised plan is created from the combination of the query as couched in SQL here, and the \".show()\" action. The latter is short-hand for displaying the first 20 entries only, and this is factored into the execution resulting in fast turn-around and a quick look at the underlying data resource. In general, all filters and other optimisations are \"pushed down\" through the execution plan at the last possible moment (when data are required to be collected from the distributed workers to the master executor in order to action an operation). This is discussed further in other example notebooks.\n\nColumn details can also be examined within the notebook by defining a data frame object against any table then echoing the schema; subsequent cells demonstrate some simple queries: \n",
      "user": "gaiauser",
      "dateUpdated": "2021-12-12 21:50:58.369",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cbr\u003e\n\u003cp\u003eThe database context is presently gaiaedr3 at start-up, so all that is needed to identify a table is the name (the first item in each record above) in queries. The column description for gaia_source is browsable within the Gaia archive ADQL search tree-view, and also \u003ca href\u003d\"https://gea.esac.esa.int/archive/documentation/GEDR3/Gaia_archive/chap_datamodel/sec_dm_main_tables/ssec_dm_gaia_source.html\"\u003eonline\u003c/a\u003e, as are the \u003ca href\u003d\"https://gea.esac.esa.int/archive/documentation/GEDR3/Gaia_archive/chap_datamodel/sec_dm_crossmatches/\"\u003ebest neighbour table columns\u003c/a\u003e. For the \u0026ldquo;external\u0026rdquo; catalogues the column sets can be browsed as follows (click on each to follow the links):\u003c/p\u003e\n\u003cul\u003e\n  \u003cli\u003e\u003ca href\u003d\"https://old.ipac.caltech.edu/2mass/releases/allsky/doc/sec2_2a.html\" title\u003d\"2MASS point-source catalogue column details\"\u003e2MASS PSC\u003c/a\u003e;\u003c/li\u003e\n  \u003cli\u003e\u003ca href\u003d\"https://wise2.ipac.caltech.edu/docs/release/allwise/expsup/sec2_1a.html\" title\u003d\"ALLWISE catalogue column details\"\u003eALLWISE\u003c/a\u003e;\u003c/li\u003e\n  \u003cli\u003e\u003ca href\u003d\"https://outerspace.stsci.edu/display/PANSTARRS/PS1+MeanObjectView+table+fields\" title\u003d\"PS1 DR1 object-thin object-mean catalogue column details\"\u003ePS1 OTMO\u003c/a\u003e (note that column names follow the Gaia archive convention of all lower-case with underscore separators rather than the original CamelCase).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIt is important to note that the best neighbour tables should not be used as a proxy for the original external survey datasets: only those records that are the best neighbour to one or more Gaia sources are included here. If you wish to query and analyse one or other of those catalogues in isolation, this is not the facility to use! The phrase \u0026ldquo;one or more\u0026rdquo; is also noteworthy: because of the way the Gaia cross-matches have been derived any one external catalogue source can be the best neighbour to more than one Gaia source. Please consult the \u003ca href\u003d\"https://gea.esac.esa.int/archive/documentation/GEDR3/Catalogue_consolidation/chap_crossmatch/\"\u003eGaia cross-match documentation on-line\u003c/a\u003e to familiarise yourself with the details.\u003c/p\u003e\n\u003cp\u003eNote also the syntax in the last query above. At first sight this might look insanely profligate, especially if you are familiar with existing relational systems serving Gaia data via ADQL/TAP. On this Spark platform the execution engine works rather differently: a \u0026ldquo;lazy\u0026rdquo; execution plan is assembled from the workflow as notebook statements and cells are \u0026ldquo;played\u0026rdquo; through this interface - nothing actually happens until absolutely necessary. So the select statement is not executed: rather an optimised plan is created from the combination of the query as couched in SQL here, and the \u0026ldquo;.show()\u0026rdquo; action. The latter is short-hand for displaying the first 20 entries only, and this is factored into the execution resulting in fast turn-around and a quick look at the underlying data resource. In general, all filters and other optimisations are \u0026ldquo;pushed down\u0026rdquo; through the execution plan at the last possible moment (when data are required to be collected from the distributed workers to the master executor in order to action an operation). This is discussed further in other example notebooks.\u003c/p\u003e\n\u003cp\u003eColumn details can also be examined within the notebook by defining a data frame object against any table then echoing the schema; subsequent cells demonstrate some simple queries:\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639345858369_1758433481",
      "id": "20210507-124618_1845823957",
      "dateCreated": "2021-12-12 21:50:58.369",
      "status": "READY"
    },
    {
      "title": "Column listing for a table",
      "text": "%pyspark\n\n# define a data frame object on a table:\ndf \u003d spark.sql(\"select * from gaia_source_ps1_best_neighbours\")\n\n# display the schema with a touch of friendly formatting:\nprint(\"Column details of gaia_source_ps1_best_neighbours:\\n\")\nfor field in df.schema: print(\"%30s : %10s\"%(field.name, field.dataType.simpleString()))\n",
      "user": "gaiauser",
      "dateUpdated": "2021-12-12 21:50:58.369",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": true,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Column details of gaia_source_ps1_best_neighbours:\n\n                     source_id :     bigint\n          clean_panstarrs1_oid :     bigint\n        original_ext_source_id :     bigint\n              angular_distance :      float\n          number_of_neighbours :    tinyint\n               number_of_mates :    tinyint\n                       xm_flag :   smallint\n                        obj_id :     bigint\n                 projection_id :   smallint\n                   sky_cell_id :   smallint\n                 obj_info_flag :        int\n                  quality_flag :   smallint\n                       ra_mean :     double\n                      dec_mean :     double\n                   ra_mean_err :      float\n                  dec_mean_err :      float\n                    epoch_mean :     double\n            n_stack_detections :   smallint\n                  n_detections :   smallint\n                            ng :   smallint\n                            nr :   smallint\n                            ni :   smallint\n                            nz :   smallint\n                            ny :   smallint\n                  g_qf_perfect :      float\n                g_mean_psf_mag :      float\n            g_mean_psf_mag_err :      float\n            g_mean_psf_mag_std :      float\n            g_mean_psf_mag_npt :   smallint\n            g_mean_psf_mag_min :      float\n            g_mean_psf_mag_max :      float\n               g_mean_kron_mag :      float\n           g_mean_kron_mag_err :      float\n                       g_flags :        int\n                  r_qf_perfect :      float\n                r_mean_psf_mag :      float\n            r_mean_psf_mag_err :      float\n            r_mean_psf_mag_std :      float\n            r_mean_psf_mag_npt :   smallint\n            r_mean_psf_mag_min :      float\n            r_mean_psf_mag_max :      float\n               r_mean_kron_mag :      float\n           r_mean_kron_mag_err :      float\n                       r_flags :        int\n                  i_qf_perfect :      float\n                i_mean_psf_mag :      float\n            i_mean_psf_mag_err :      float\n            i_mean_psf_mag_std :      float\n            i_mean_psf_mag_npt :   smallint\n            i_mean_psf_mag_min :      float\n            i_mean_psf_mag_max :      float\n               i_mean_kron_mag :      float\n           i_mean_kron_mag_err :      float\n                       i_flags :        int\n                  z_qf_perfect :      float\n                z_mean_psf_mag :      float\n            z_mean_psf_mag_err :      float\n            z_mean_psf_mag_std :      float\n            z_mean_psf_mag_npt :   smallint\n            z_mean_psf_mag_min :      float\n            z_mean_psf_mag_max :      float\n               z_mean_kron_mag :      float\n           z_mean_kron_mag_err :      float\n                       z_flags :        int\n                  y_qf_perfect :      float\n                y_mean_psf_mag :      float\n            y_mean_psf_mag_err :      float\n            y_mean_psf_mag_std :      float\n            y_mean_psf_mag_npt :   smallint\n            y_mean_psf_mag_min :      float\n            y_mean_psf_mag_max :      float\n               y_mean_kron_mag :      float\n           y_mean_kron_mag_err :      float\n                       y_flags :        int\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639345858369_613061732",
      "id": "20210507-133844_1243154051",
      "dateCreated": "2021-12-12 21:50:58.369",
      "status": "READY"
    },
    {
      "title": "Querying the main catalogue",
      "text": "%pyspark\n\n# querying the main catalogue table is as simple as forming an SQL query:\ndf \u003d spark.sql(\"select source_id, ra, dec, phot_g_mean_mag AS G from gaia_source\")\n\ndf.show()\n\n",
      "user": "gaiauser",
      "dateUpdated": "2021-12-12 21:50:58.369",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": true,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------------+------------------+-------------------+---------+\n|       source_id|                ra|                dec|        G|\n+----------------+------------------+-------------------+---------+\n|   6975027056128|44.976206974203215|0.19597223687938073|21.247803|\n|  69410967253632| 45.33365180640389| 0.8065718615590686|16.937292|\n| 225949639778432| 45.44124688351276| 1.1954836699775477|15.183385|\n| 312643555148800| 44.19331490047449| 1.0141376381509917| 20.36981|\n| 442897027616128| 44.91264312888683|  1.492601852016502|20.322088|\n| 474301831162240| 45.48856296035135| 1.8741327094367917| 20.83472|\n| 503129650290944| 44.82557241329517| 1.7467209989897743|     null|\n| 648265184276864| 46.15329115883016| 1.8187255026806104|19.259766|\n| 853633342492160|45.887170370964405| 1.9883446636479867|21.079979|\n| 863460225866368| 45.45010424853958| 2.0228507314198554|19.692091|\n|1280793609641728| 44.43124938681589|  2.100706635709667|20.628544|\n|1393218671780096|44.187676857318436| 2.6694704253082144|19.574331|\n|1428059446105344|42.816607265146295| 2.0886145542579504|17.997023|\n|1493793921413120|42.757454396411674|  2.452213240447886| 12.09738|\n|1674835382563840| 43.44455576953005| 3.2773066677599725| 20.83849|\n|1855288436653952| 45.47653260521487| 3.3701162952663966|20.267406|\n|2016951004457088| 44.91770710226973| 3.5664154263442804|20.959341|\n|2088934654473728|44.560611955234315|  3.937445649369211|16.952032|\n|2358486801948416|47.787928879606234|  3.041189850119304|19.899597|\n|2358800334580352| 47.73775437161764|  3.060588469149176|15.646799|\n+----------------+------------------+-------------------+---------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639345858369_1052702730",
      "id": "20210507-140821_1444471628",
      "dateCreated": "2021-12-12 21:50:58.369",
      "status": "READY"
    },
    {
      "title": "Querying with cross-matched data",
      "text": "%pyspark\n\n# a simple SQL join on Gaia source_id can be used to pull in external catalogue data with Gaia data via the pre-computed best-neighbour joins:\n#query \u003d \"SELECT g.source_id, ra, dec, phot_g_mean_mag AS G, g_mean_psf_mag AS g_ps1, r_mean_psf_mag AS r_ps1\" + \\\n    #\" FROM gaia_source AS g INNER JOIN gaia_source_ps1_best_neighbours AS p ON g.source_id \u003d p.source_id\"\n\nquery\u003d \"SELECT gaia.source_id, gaia.ra, gaia.dec, gaia.phot_g_mean_mag AS gaia_g, ps1.g_mean_psf_mag AS ps1_g, ps1.r_mean_psf_mag AS ps1_r FROM gaia_source AS gaia INNER JOIN gaia_source_ps1_best_neighbours AS ps1 ON gaia.source_id \u003d ps1.source_id\"\n\n# define a data frame object on this query\ndf \u003d spark.sql(query)\n\n# echo first 20 records of the results set\ndf.show()\n",
      "user": "gaiauser",
      "dateUpdated": "2021-12-12 21:50:58.369",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------------+------------------+-------------------+---------+-------+-------+\n|       source_id|                ra|                dec|   gaia_g|  ps1_g|  ps1_r|\n+----------------+------------------+-------------------+---------+-------+-------+\n|   6975027056128|44.976206974203215|0.19597223687938073|21.247803|20.8992|19.7456|\n|  69410967253632| 45.33365180640389| 0.8065718615590686|16.937292|18.3138|17.0573|\n| 225949639778432| 45.44124688351276| 1.1954836699775477|15.183385|15.8463|15.1432|\n| 312643555148800| 44.19331490047449| 1.0141376381509917| 20.36981|20.6292|20.3524|\n| 442897027616128| 44.91264312888683|  1.492601852016502|20.322088|20.4575|20.1683|\n| 474301831162240| 45.48856296035135| 1.8741327094367917| 20.83472|21.5876|20.8279|\n| 503129650290944| 44.82557241329517| 1.7467209989897743|     null|22.1183|21.5088|\n| 648265184276864| 46.15329115883016| 1.8187255026806104|19.259766|21.1136|19.6957|\n| 853633342492160|45.887170370964405| 1.9883446636479867|21.079979|  22.13|21.2637|\n| 863460225866368| 45.45010424853958| 2.0228507314198554|19.692091| 21.194|19.9263|\n|1280793609641728| 44.43124938681589|  2.100706635709667|20.628544|22.0913|  20.98|\n|1393218671780096|44.187676857318436| 2.6694704253082144|19.574331|21.8862|  20.63|\n|1428059446105344|42.816607265146295| 2.0886145542579504|17.997023|19.3967|18.1068|\n|1674835382563840| 43.44455576953005| 3.2773066677599725| 20.83849|20.5093|19.3258|\n|1855288436653952| 45.47653260521487| 3.3701162952663966|20.267406|21.8331|20.7476|\n|2016951004457088| 44.91770710226973| 3.5664154263442804|20.959341| -999.0|22.0158|\n|2088934654473728|44.560611955234315|  3.937445649369211|16.952032|17.4507|16.9365|\n|2358486801948416|47.787928879606234|  3.041189850119304|19.899597|21.4396|20.3401|\n|2358800334580352| 47.73775437161764|  3.060588469149176|15.646799|16.1171|15.6355|\n|2669236275538432| 47.23182395824929|  4.068078201830116| 20.04851|20.7575|20.0098|\n+----------------+------------------+-------------------+---------+-------+-------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639345858369_220004959",
      "id": "20210507-144257_1004220319",
      "dateCreated": "2021-12-12 21:50:58.369",
      "status": "READY"
    },
    {
      "title": "Things to note",
      "text": "%md\n\n* although SQL-based, the API is much richer than SQL/ADQL in terms of programmability and flexibility in column types - this will become increasingly important in future data releases.\n* the are no ADQL geometric functions to limit spatially selections - the platform is designed primarily for large-scale statistical analyses and does not replicate all features of existing relational systems, especially those needed to delimit row sets to small sub-samples.\n* ...\n\n\n\n",
      "user": "gaiauser",
      "dateUpdated": "2021-12-12 21:50:58.369",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cul\u003e\n  \u003cli\u003ealthough SQL-based, the API is much richer than SQL/ADQL in terms of programmability and flexibility in column types - this will become increasingly important in future data releases.\u003c/li\u003e\n  \u003cli\u003ethe are no ADQL geometric functions to limit spatially selections - the platform is designed primarily for large-scale statistical analyses and does not replicate all features of existing relational systems, especially those needed to delimit row sets to small sub-samples.\u003c/li\u003e\n  \u003cli\u003e\u0026hellip;\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639345858369_1785861291",
      "id": "20210507-144728_1143294166",
      "dateCreated": "2021-12-12 21:50:58.369",
      "status": "READY"
    },
    {
      "text": "%md\n",
      "user": "gaiauser",
      "dateUpdated": "2021-12-12 21:50:58.369",
      "progress": 0,
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639345858369_1053437492",
      "id": "20210507-144934_423944230",
      "dateCreated": "2021-12-12 21:50:58.369",
      "status": "READY"
    }
  ],
  "name": "Data holdings",
  "id": "2GRA39HCN",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.0",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}